<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link
      id="favicon-light"
      href="/LightIcon.svg"
      rel="icon"
      media="(prefers-color-scheme: light)"
    />
    <link
      id="favicon-dark"
      href="/DarkIcon.svg"
      rel="icon"
      media="(prefers-color-scheme: dark)"
    />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover, interactive-widget=resizes-content"
    />
    <meta name="theme-color" content="#121212" />
    <title>Escruta</title>
    <meta name="application-name" content="Escruta" />
    <meta name="format-detection" content="telephone=no" />
    <script>
      (function () {
        function getCookie(name) {
          const value = `; ${document.cookie}`;
          const parts = value.split(`; ${name}=`);
          if (parts.length === 2) return parts.pop().split(";").shift();
        }

        function initializeTheme() {
          let themePreference;
          try {
            const cookieValue = getCookie("themePreference");
            themePreference = cookieValue
              ? JSON.parse(decodeURIComponent(cookieValue))
              : "System";
          } catch (e) {
            themePreference = "System";
          }

          document.documentElement.classList.remove("dark", "light");

          if (themePreference === "Dark") {
            document.documentElement.classList.add("dark");
          } else if (themePreference === "Light") {
            document.documentElement.classList.add("light");
          } else {
            if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
              document.documentElement.classList.add("dark");
            } else {
              document.documentElement.classList.add("light");
            }
          }
        }

        initializeTheme();
      })();
    </script>

    <script>
      (function () {
        const version = Date.now();
        function updateFavicon() {
          const faviconLight = document.getElementById("favicon-light");
          const faviconDark = document.getElementById("favicon-dark");

          if (document.hidden) {
            faviconLight.href = `/LightIcon.svg?v=${version}`;
            faviconDark.href = `/DarkIcon.svg?v=${version}`;
          } else {
            faviconLight.href = `/Icon.svg?v=${version}`;
            faviconDark.href = `/Icon.svg?v=${version}`;
          }
        }
        updateFavicon();
        document.addEventListener("visibilitychange", updateFavicon);
      })();
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Escruta",
        "description": "Organize, analyze, and learn from your own knowledge. Ask questions, take notes, and get insightsâ€”all in a open-source platform.",
        "url": "https://escruta.com",
        "applicationCategory": "ProductivityApplication",
        "operatingSystem": "Web",
        "author": {
          "@type": "Person",
          "name": "Francisco Mesa",
          "url": "https://francids.com"
        },
        "screenshot": "https://escruta.com/AppScreenshot.webp",
        "featureList": [
          "AI-powered knowledge management",
          "Note taking and organization",
          "Document analysis",
          "Study guide generation",
          "Flashcard creation",
          "Mind mapping",
          "Audio summaries"
        ]
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
